{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"scheduler-entry","identifier":"akeneo-fetch-complete-products","name":"Akeneo - Fetch complete products","description":"This scheduler will fetch the complete products data from the Akeneo and save it into the storage \"Alumio - Product Model Parent - Alumio Base Product Model\"\n\nWith step of\n\n1. Fetch variants of Product from Akeneo by running the Incoming \"Akeneo - Fetch - Products with parent\".\n\n2. Fetch parent Product Model from Akeneo by running the Incoming \"Akeneo - Product Models without parent\".\n\n3. Fetch children Product Model from Akeneo by running the Incoming \"Akeneo - Fetch - Product Models with parent\".\n\n4. Fetch Simple Product from Akeneo by running the Incoming \"Akeneo - Fetch - Products without parent\".","object":{"parameters":{"job":[{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-products-with-parent"}},{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-product-models-without-parent"}},{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-product-models-with-parent"}},{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-products-without-parent"}}],"handlers":[],"priority":2,"expression":"0 * * * *"}},"owner":null,"disabled":true}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-products-with-parent","name":"Akeneo - Fetch - Products with parent","description":"We defined variants as the product of a product model. Before we fetch the product model in Akeneo, we need to prepare the variants first (the product of the product model). This Incoming is designed to get products in Akeneo which have parent, so we can be sure this will be variant from the product model.\n\nThis Incoming is designed to get products in Akeneo which have parent, so we can be sure this will be variant from the product model.\n\nThis Incoming will not create any task but will update the storage of \"Akeneo - Update Storage - Product Model Variants - Alumio Base Product\" with a list of product data in Alumio base product data.","object":{"parameters":{"entityType":"base-product-model-1","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/products?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next"}},"transformer":{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"NOT EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile"}}}},"transformers":["akeneo-prepare-convert-localizations-filter-for-spryker","akeneo-values-initial-prepare-convert-values-into-localization-and-customattributes","akeneo-categories-prepare-convert-categories-to-alumio-base","akeneo-price-prepare-map-price-from-customattributes","akeneo-product-convert-into-alumio-base-product-after-prepare","akeneo-update-storage-product-model-variants-alumio-base-product"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"http-client","identifier":"akeneo-http-client","name":"Akeneo - HTTP Client","description":"","object":{"prototype":"akeneo-http-client-v2","parameters":{"key":"", "baseUri":"${AKENEO_BASE_URL}","clientId":"${AKENEO_CLIENT_ID}","password":"${AKENEO_PASSWORD}","username":"${AKENEO_USERNAME}","clientSecret":"${AKENEO_CLIENT_SECRET}"}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-convert-localizations-filter-for-spryker","name":"Akeneo - Prepare Convert - Localizations filter for Spryker","description":"This transformer will filter localization with certain channel code if exists.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"localizations"}},"nodeFilters":[{"prototype":"or-condition","parameters":{"filters":[{"prototype":"and-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-exists-condition","parameters":{"path":"channelCode"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"channelCode"}},"conditions":[{"prototype":"one-of","parameters":{"value":["ecommerce"]}}]}}]}},{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-not-exists-condition","parameters":{"path":"channelCode"}}}}]}}],"nodeTransformers":[]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"localizations"}}}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-values-initial-prepare-convert-values-into-localization-and-customattributes","name":"Akeneo - Prepare convert - Values - To localizations and custom attributes","description":"Convert values without scope and locale into customAttributes and those who have into localization","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"attribute_type"}},"conditions":[{"prototype":"equals","parameters":{"value":"pim_catalog_image"}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"_links"}]}}],"elseTransformers":[]}},{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"combinedKey","value":"locale:?{locale}|scope:?{scope}","mappers":[]}]}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"attribute_type"},{"key":"reference_data_name"}]}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[]}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"structure","parameters":{"key":"combinedKey","keys":[],"value":"\"\""}},"destination":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"values.*.*","conditions":[],"replacement":"values.$2.$1"}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"values"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"values.*.*.combinedKey"}]}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*.data","conditions":[],"replacement":"customAttributes.$1"}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*.scope","conditions":[],"replacement":"channelCode"}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*.locale","conditions":[],"replacement":"localeCode"}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[]}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"values.\"locale:|scope:\".customAttributes","conditions":[],"replacement":"customAttributes"}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values"}}}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"values","conditions":[],"replacement":"localizations"}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-categories-prepare-convert-categories-to-alumio-base","name":"Akeneo - Prepare convert - Product and product model - Categories to Alumio Base","description":"This transformer will convert categories data from Akeneo.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"key","parameters":{"keys":[],"root":"categories"}},"destination":{"prototype":"structure","parameters":{"key":"temp","keys":[],"root":"categories","value":"categoryCode"}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"categories"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"temp"}]}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"categories"}}}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-price-prepare-map-price-from-customattributes","name":"Akeneo - Prepare convert - Product and product model - Prices to Alumio Base","description":"Please run transformer Akeneo - Prepare convert - Values - To localizations and custom attributes' before using this\n\nThis transformer will convert prices data from Akeneo.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"customAttributes.price","conditions":[],"replacement":"prices"}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"prices.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"currency","conditions":[],"replacement":"currencyCode"}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-product-convert-into-alumio-base-product-after-prepare","name":"Akeneo - Convert - Product - To Alumio Base product","description":"Please run the Prepare transformer before using this.\n\nIt will finally convert Akeneo product into Alumio Base Product (https://schemas.alumio.com/v2/Product.json).","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"customAttributes.sku","conditions":[],"replacement":"code"}},{"meta":[],"prototype":"key-mapper","parameters":{"mappers":[{"prototype":"dictionary-map","parameters":{"map":[["parent","parentCode"],["enabled","statusCode"],["family","attributeSetCode"]],"comparator":"equals"}}],"accessor":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"uuid"},{"key":"_links"},{"key":"created"},{"key":"updated"},{"key":"associations"},{"key":"quantified_associations"},{"key":"metadata"}]}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-update-storage-product-model-variants-alumio-base-product","name":"Akeneo - Update Storage - Product Model Variants - Alumio Base Product","description":"","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*","conditions":[],"replacement":"variant.$1"}},{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"akeneo-product-model-variants-alumio-base-product","storageKey":"&{variant.parentCode}","destination":"variants"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"or-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-not-exists-condition","parameters":{"path":"variants"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"variant","conditions":[],"replacement":"variants.0"}}],"elseTransformers":[{"meta":[],"prototype":"list-transformer-wrapper","parameters":{"transformers":["akeneo-prepare-update-product-model-variants-alumio-base-variant-merge"]}}]}},{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"source":"variants","storage":"akeneo-product-model-variants-alumio-base-product","storageKey":"&{variant.parentCode}"}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"akeneo-product-model-variants-alumio-base-product","name":"Akeneo - Product Model variants - Alumio Base Product","description":"","object":{"parameters":{"path":"akeneo-product-model-variants-alumio-base-product-01JPS9G7NG8SG45JMSA9HXB925","logger":{"parameters":{"actions":[]}}}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-update-product-model-variants-alumio-base-variant-merge","name":"Akeneo - Prepare update - Product Model Variants - Alumio Base Variant merge","description":"Merge variant into key variants","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"structure","parameters":{"key":"code","keys":[],"value":"\"\""}},"destination":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"variants.&{variant.code}","value":"&{variant}","mappers":[]}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}}}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-product-models-without-parent","name":"Akeneo - Fetch - Product Models without parent","description":"Parent product model in Akeneo has a probability to have children which is another product model or variant which is the product of the product model. This Incoming is designed to get a list of product model which is the top parent or doesn't have parent.\n\nThis Incoming is designed to get a list of product model which is the top parent or doesn't have parent.\n\nThis Incoming will not create any task but will update the storage of \"Alumio - Product Model Parent - Alumio Base Product Model\" with parent product model data in Alumio base product model.","object":{"parameters":{"entityType":"base-product-model-1","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/product-models?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"serializer":{"prototype":"json","parameters":[]},"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next"}},"transformer":{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile"}}}},"transformers":["akeneo-values-initial-prepare-convert-values-into-localization-and-customattributes","akeneo-prepare-convert-localizations-filter-for-spryker","akeneo-categories-prepare-convert-categories-to-alumio-base","akeneo-price-prepare-map-price-from-customattributes","akeneo-productmodel-convert-into-alumio-base-productmodel-after-prepare","alumio-fetch-storage-alumio-base-product-model-attach-variants","akeneo-update-storage-product-model-parent-alumio-base-product-model"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-productmodel-convert-into-alumio-base-productmodel-after-prepare","name":"Akeneo - Convert - Product Model - To Alumio Base Product Model","description":"Please run the Prepare transformer before using this.\n\nIt will finally convert Akeneo ProductModel into Alumio Base ProductModel (https://schemas.alumio.com/v2/ProductModel.json).","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"key-mapper","parameters":{"mappers":[{"prototype":"dictionary-map","parameters":{"map":[["parent","parentCode"],["enabled","statusCode"],["family","attributeSetCode"]],"comparator":"equals"}}],"accessor":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"_links"},{"key":"created"},{"key":"updated"},{"key":"associations"},{"key":"quantified_associations"},{"key":"metadata"},{"key":"family_variant"}]}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"alumio-fetch-storage-alumio-base-product-model-attach-variants","name":"Alumio - Fetch storage - Alumio Base Product Model attach variants","description":"This transformer will fetch the data of variant that was created from the Incoming \"Akeneo - Fetch - Products with parent\" and attach it as a variants to the Alumio base product model.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"akeneo-product-model-variants-alumio-base-product","storageKey":"&{code}","destination":"variants"}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-update-storage-product-model-parent-alumio-base-product-model","name":"Akeneo - Update storage - Product Model parent - Alumio Base Product Model","description":"","object":{"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"storage":"alumio-product-model-parent-alumio-base-product-model","storageKey":"&{code}"}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"alumio-product-model-parent-alumio-base-product-model","name":"Alumio - Product Model Parent - Alumio Base Product Model","description":"","object":{"parameters":{"path":"alumio-product-model-parent-alumio-base-product-model-01JPS9G7NK7J1C1XHFV4WTQ4QV","logger":{"parameters":{"actions":[]}}}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-product-models-with-parent","name":"Akeneo - Fetch - Product Models with parent","description":"This Incoming well get the product model with parent to become a children product model.\n\nThis Incoming will not create any task but will update the storage of the parent at \"Alumio - Product Model Parent - Alumio Base Product Model\" with children product model data in Alumio base product model.","object":{"parameters":{"entityType":"base-product-model-1","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/product-models?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next"}},"transformer":{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"NOT EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile"}}}},"transformers":["akeneo-values-initial-prepare-convert-values-into-localization-and-customattributes","akeneo-prepare-convert-localizations-filter-for-spryker","akeneo-categories-prepare-convert-categories-to-alumio-base","akeneo-price-prepare-map-price-from-customattributes","akeneo-productmodel-convert-into-alumio-base-productmodel-after-prepare","alumio-fetch-storage-alumio-base-product-model-attach-variants","akeneo-filter-and-prepare-update-storage-filter-for-product-model-without-variants-and-update-parent"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-filter-and-prepare-update-storage-filter-for-product-model-without-variants-and-update-parent","name":"Akeneo - Filter and prepare update storage - Filter for product model without variants and update parent","description":"This transformer will filter product model without variant and will update the parent if not filtered.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}},"conditions":[{"prototype":"logic-and","parameters":{"conditions":[{"prototype":"not-equals","parameters":{"value":null}},{"prototype":"not-equals","parameters":{"value":[]}}]}}]}}],"transformers":["akeneo-update-storage-alumio-base-product-model-update-children"]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-update-storage-alumio-base-product-model-update-children","name":"Akeneo - Update storage - Alumio Base Product Model update children","description":"This transformer will update the parent product model inside the storage \"Alumio - Product Model Parent - Alumio Base Product Model\" with the product model provided in the data.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*","conditions":[],"replacement":"child.$1"}},{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"alumio-product-model-parent-alumio-base-product-model","storageKey":"&{child.parentCode}","destination":"parent"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"or-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-not-exists-condition","parameters":{"path":"parent.children"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent.children"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"child","conditions":[],"replacement":"parent.children.0"}}],"elseTransformers":[{"meta":[],"prototype":"list-transformer-wrapper","parameters":{"transformers":["akeneo-prepare-update-alumio-base-product-model-merge-children-with-parent"]}}]}},{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"source":"parent","storage":"alumio-product-model-parent-alumio-base-product-model","storageKey":"&{parent.code}"}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-update-alumio-base-product-model-merge-children-with-parent","name":"Akeneo - Prepare update - Alumio Base Product Model merge children with parent","description":"This transformer will merge the childrens of Alumio Base Product Model parent.","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent.children"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"structure","parameters":{"key":"code","keys":[],"value":"\"\""}},"destination":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"parent.children.&{child.code}","value":"&{child}","mappers":[]}]}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"child"}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent.children"}}}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-products-without-parent","name":"Akeneo - Fetch - Products without parent","description":"There some products data without product model in Akeneo.\n\nThis Incoming will duplicate the product data into Alumio base product model and save them into the storage \"Alumio - Product Model Parent - Alumio Base Product Model\".","object":{"parameters":{"entityType":"base-product-model-1","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/products?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next","pageLimit":1000}},"transformer":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile"}}}},"transformers":["akeneo-values-initial-prepare-convert-values-into-localization-and-customattributes","akeneo-prepare-convert-localizations-filter-for-spryker","akeneo-categories-prepare-convert-categories-to-alumio-base","akeneo-price-prepare-map-price-from-customattributes","akeneo-product-convert-into-alumio-base-product-after-prepare","akeneo-convert-alumio-base-product-to-alumio-base-product-model-with-variants","akeneo-update-storage-product-model-parent-alumio-base-product-model"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-convert-alumio-base-product-to-alumio-base-product-model-with-variants","name":"Akeneo - Convert - Alumio Base Product - To Alumio Base Product Model with variants","description":"  This transformer will copy the Alumio base product data into Alumio base product model with variant.\n\n  We add the variant code with \"-1\" to avoid data duplication.\n\n","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"*","conditions":[],"replacement":"variants.0.$1"}},{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"code","conditions":[],"replacement":"variants.0.parentCode"}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"string-append","parameters":{"append":"-1"}}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants.0.code"}}}}]}}]}},"owner":null,"disabled":false}
