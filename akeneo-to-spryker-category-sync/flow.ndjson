{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"scheduler-entry","identifier":"akeneo-fetch-and-check-categories","name":"Akeneo - Fetch Categories","description":"","object":{"parameters":{"job":[{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-categories"}}],"handlers":[],"priority":2,"expression":"*/5 * * * *"}},"owner":null,"disabled":true}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-categories","name":"Akeneo - Fetch - Categories","description":"Fetch all categories from Akeneo and create them into Alumio Task","object":{"parameters":{"entityType":"base-category","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/categories","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next"}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile"}}}},"transformers":["akeneo-prepare-convert-category-labels-to-localizations","akeneo-convert-category-to-alumio-base","akeneo-filter-category"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"http-client","identifier":"akeneo-http-client","name":"Akeneo - HTTP Client","description":"","object":{"prototype":"akeneo-http-client-v2","parameters":{"key":"01JBGPYYMG2VT7GS93S2C4PDXT","baseUri":"${AKENEO_BASE_URL}","clientId":"${AKENEO_CLIENT_ID}","password":"${AKENEO_PASSWORD}","username":"${AKENEO_USERNAME}","clientSecret":"${AKENEO_CLIENT_SECRET}","enableLogging":true,"loggerFormatter":"full"}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-convert-category-labels-to-localizations","name":"Akeneo - Prepare convert category - Labels - To localizations","description":"Preparing convert into Alumio Base Category by converting labels into array consist of localCode and localizations","object":{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"key","parameters":{"keys":[],"root":"labels"}},"destination":{"prototype":"structure","parameters":{"key":"localeCode","keys":[],"root":"localizations","value":"translation"}},"stripEnclosures":true}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"labels"}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"transformer-test","identifier":"akeneo-prepare-convert-category-labels-to-localizations--category-1","name":"Category 1","description":null,"object":{"parameters":{"entity":{"code":"master","labels":{"de_DE":"E-commerce","en_GB":"E-commerce","en_US":"E-commerce","es_ES":"E-commerce","fr_FR":"E-commerce","it_IT":"E-commerce","nl_NL":"E-commerce","pt_PT":"E-commerce"},"parent":null,"updated":"2024-11-04T16:24:05+00:00"},"expected":{"expected":[[]]}}},"owner":"akeneo-prepare-convert-category-labels-to-localizations","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-convert-category-to-alumio-base","name":"Akeneo - Convert - Category - To Alumio Base","description":"Convert Akeneo Category into Alumio Base Category","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"_links"},{"key":"updated"}]}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"transformer-test","identifier":"akeneo-convert-category-to-alumio-base--category-1","name":"Category 1","description":null,"object":{"parameters":{"entity":{"code":"master","parent":null,"updated":"2024-11-04T16:24:05+00:00","localizations":[{"localeCode":"de_DE","translation":"E-commerce"},{"localeCode":"en_GB","translation":"E-commerce"},{"localeCode":"en_US","translation":"E-commerce"},{"localeCode":"es_ES","translation":"E-commerce"},{"localeCode":"fr_FR","translation":"E-commerce"},{"localeCode":"it_IT","translation":"E-commerce"},{"localeCode":"nl_NL","translation":"E-commerce"},{"localeCode":"pt_PT","translation":"E-commerce"}]},"expected":{"expected":[[]]}}},"owner":"akeneo-convert-category-to-alumio-base","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-filter-category","name":"Akeneo - Filter - Category","description":"Filter Alumio Base Category which previously created into task  to avoid duplication","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"type-setter","parameters":{"entityType":"base-category"}},{"meta":[],"prototype":"storage-filter-stored-entity","parameters":{"storage":"akeneo-filter-categories","addEntityToStorage":true}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"akeneo-filter-categories","name":"Akeneo - Filter - Categories","description":"","object":{"parameters":{"path":"akeneo-filter-categories-01JPS9G7NEKYJ7J96G9JS4PXS9","logger":{"parameters":{"actions":[]}}}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-transformer-test","identifier":"akeneo-fetch-categories--test-category-1","name":"Test Category 1","description":null,"object":{"parameters":{"entity":{"code":"master","labels":{"de_DE":"E-commerce","en_GB":"E-commerce","en_US":"E-commerce","es_ES":"E-commerce","fr_FR":"E-commerce","it_IT":"E-commerce","nl_NL":"E-commerce","pt_PT":"E-commerce"},"parent":null,"updated":"2024-11-04T16:24:05+00:00"},"expected":{"expected":[[]]}}},"owner":"akeneo-fetch-categories","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-transformer-test","identifier":"akeneo-fetch-categories--test-category-2","name":"Test Category 2","description":null,"object":{"parameters":{"entity":{"code":"fashion","labels":{"de_DE":"Kleidung","en_GB":"Clothing","en_US":"Clothing","es_ES":"Ropa","fr_FR":"V\u00eatements","it_IT":"Abbigliamento","nl_NL":"Kleding","pt_PT":"Roupas"},"parent":"master","updated":"2024-11-04T16:24:06+00:00"},"expected":{"expected":[[]]}}},"owner":"akeneo-fetch-categories","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"scheduler-entry","identifier":"spryker-send-categories","name":"Spryker - Send Categories","description":"This scheduler will fetch Spryker categories for checking and sync them","object":{"parameters":{"job":[{"prototype":"run-incoming","parameters":{"incoming":"spryker-fetch-categories"}},{"prototype":"run-outgoing","parameters":{"route":"akeneo-synchronize-categories-to-spryker","numTasks":15}}],"handlers":[],"priority":2,"expression":"*/5 * * * *"}},"owner":null,"disabled":true}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"spryker-fetch-categories","name":"Spryker - Fetch - Categories","description":"Before we send categories into Spryker system, we need to know first which categories are already exists in the Spryker System.\n\nSo, this Incoming is intended to fetch the categories data in Spryker System and save them with transformer \"Spryker - Update storage - Category full data\".\n\nThe result of this Incoming would not be created into Task but will be saved into storage name \"Spryker - Categories - Full Data\".","object":{"parameters":{"subscriber":{"prototype":"http-subscriber","parameters":{"client":"spryker-backoffice-glue","request":{"uri":"/categories","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"deserializer":{"prototype":"json","parameters":{"pattern":"data","readMethod":"wholeFile"}}}},"transformers":["spryker-update-storage-category-full-data"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"http-client","identifier":"spryker-backoffice-glue","name":"Spryker - Backoffice Glue","description":"","object":{"prototype":"alumio-spryker-dynamic-data-exchange-http-client-v2","parameters":{"key":"01JH4QM3K95013ZFMCBFVT5D63","baseUrl":"${SPRYKER_BACKOFFICE_GLUE_BASE_URI}","password":"${SPRYKER_BACKOFFICE_GLUE_PASSWORD}","username":"${SPRYKER_BACKOFFICE_GLUE_USERNAME}","enableLogging":true,"loggerFormatter":"full"}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"http-client-test","identifier":"spryker-backoffice-glue--http-client-test","name":"spryker-backoffice-glue http-client Test","description":null,"object":{"parameters":{"uri":"/dynamic-entity/stores","method":"GET"}},"owner":"spryker-backoffice-glue","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"spryker-update-storage-category-full-data","name":"Spryker - Update storage - Category full data","description":"Saving Spryker Category data for Route Akeneo Synchronize Categories to Spryker to perform","object":{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"storage":"srpyker-categories-full-data","storageKey":"&{id}"}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"srpyker-categories-full-data","name":"Spryker - Categories - Full Data","description":"","object":{"parameters":{"path":"srpyker-categories-full-data-01JPS9G7NV46M89ZSZKCWPFJHJ","logger":{"parameters":{"actions":[]}}}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"route-configuration","identifier":"akeneo-synchronize-categories-to-spryker","name":"Akeneo Synchronize Categories to Spryker","description":"Syncronize Categories Data  from Akeneo system into Spryker system","object":{"parameters":{"incoming":"akeneo-fetch-categories","outgoing":"spryker-send-category","realtime":false,"transformers":[],"waitingStatus":false,"parallelExecution":[]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"outgoing-configuration","identifier":"spryker-send-category","name":"Spryker - Send - Category","description":"","object":{"parameters":{"publisher":{"prototype":"no-action-publisher","parameters":[]},"transformers":["spryker-convert-alumio-base-category-to-spryker-category","spryker-filter-category-filter-localizedattributes-for-en-us-and-de-de","spryker-prepare-send-category-check-and-fill-parent-sort-order","spryker-check-and-send-category","spryker-update-storage-category-full-data"]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"spryker-convert-alumio-base-category-to-spryker-category","name":"Spryker - Convert - Alumio Base Category - To Spryker Category","description":"","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"prototype":"value-setter","parameters":{"configurations":[{"key":"store","value":["DE","AT"],"mappers":[]},{"key":"rootParent","value":"demoshop","mappers":[]}]}},{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"data","value":{"id":"&{code}","type":"categories","attributes":{"stores":"&{store}","isActive":true,"isInMenu":true,"categoryKey":"&{code}","isClickable":true,"isSearchable":true}},"mappers":[]}]}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"localizations","conditions":[],"replacement":"data.attributes.localizedAttributes"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"and-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-exists-condition","parameters":{"path":"parent"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent"}},"conditions":[{"prototype":"not-equals","parameters":{"value":null}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"parent","conditions":[],"replacement":"data.attributes.parent.categoryKey"}},{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"data.attributes.parent.sortOrder","value":100,"mappers":[]}]}}],"elseTransformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"data.attributes.parent.sortOrder","value":"100","mappers":[]},{"key":"data.attributes.parent.categoryKey","value":"&{rootParent}","mappers":[]}]}}]}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"data.attributes.localizedAttributes"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"localeCode","conditions":[],"replacement":"locale"}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"translation","conditions":[],"replacement":"name"}},{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"name","conditions":[],"replacement":"metaTitle"}},{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"name","conditions":[],"replacement":"metaDescription"}},{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"name","conditions":[],"replacement":"metaKeywords"}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"key-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[]}},"conditions":[{"prototype":"not-equals","parameters":{"value":"data"}}]}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"transformer-test","identifier":"spryker-convert-alumio-base-category-to-spryker-category--category-1","name":"Category 1","description":null,"object":{"parameters":{"entity":{"code":"master","parent":null,"localizations":[{"localeCode":"de_DE","translation":"E-commerce"},{"localeCode":"en_GB","translation":"E-commerce"},{"localeCode":"en_US","translation":"E-commerce"},{"localeCode":"es_ES","translation":"E-commerce"},{"localeCode":"fr_FR","translation":"E-commerce"},{"localeCode":"it_IT","translation":"E-commerce"},{"localeCode":"nl_NL","translation":"E-commerce"},{"localeCode":"pt_PT","translation":"E-commerce"}]},"expected":{"expected":[[]]}}},"owner":"spryker-convert-alumio-base-category-to-spryker-category","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"spryker-filter-category-filter-localizedattributes-for-en-us-and-de-de","name":"Spryker - Filter Category - Filter localized attributes by locale","description":"","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"data.attributes.localizedAttributes.*"}},"nodeFilters":[{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"locale"}},"conditions":[{"prototype":"one-of","parameters":{"value":["en_US","de_DE"]}}]}}],"nodeTransformers":[]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"data.attributes.localizedAttributes"}}}}]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"spryker-prepare-send-category-check-and-fill-parent-sort-order","name":"Spryker - Prepare Send Category - Check and fill parent sort order","description":"","object":{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"and-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-exists-condition","parameters":{"path":"data.attributes.parent"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"data.attributes.parent.categoryKey"}},"conditions":[{"prototype":"not-one-of","parameters":{"value":[null,null]}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"spryker-category-parent-sort-order","storageKey":"&{data.attributes.parent.categoryKey}","destination":"testParent"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"and-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-exists-condition","parameters":{"path":"testParent"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"testParent"}},"conditions":[{"prototype":"not-one-of","parameters":{"value":[null]}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"testParent","conditions":[],"replacement":"testParent.0"}},{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"testParent.1","value":1,"mappers":[]}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"operator","parameters":{"operator":"addition"}}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"testParent"}}}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"testParent","conditions":[],"replacement":"data.attributes.parent.sortOrder"}}],"elseTransformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"data.attributes.parent.sortOrder","value":100,"mappers":[]}]}}]}},{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"source":"data.attributes.parent.sortOrder","storage":"spryker-category-parent-sort-order","storageKey":"&{data.attributes.parent.categoryKey}"}}],"elseTransformers":[]}}]}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"spryker-category-parent-sort-order","name":"Spryker - Category Parent Sort Order","description":"","object":{"parameters":{"path":"spryker-category-parent-sort-order-01JPS9G7NYCTB045SSRPVZ9XSA","logger":{"parameters":{"actions":[]}}}},"owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"transformer-test","identifier":"spryker-prepare-send-category-check-and-fill-parent-sort-order--test-1","name":"Test 1","description":null,"object":{"parameters":{"entity":{"data":{"id":"master","type":"categories","attributes":{"parent":{"sortOrder":"100","categoryKey":"demoshop"},"stores":["DE","AT"],"isActive":true,"isInMenu":true,"categoryKey":"master","isClickable":true,"isSearchable":true,"localizedAttributes":[{"name":"E-commerce","locale":"de_DE","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"en_GB","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"en_US","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"es_ES","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"fr_FR","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"it_IT","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"nl_NL","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"},{"name":"E-commerce","locale":"pt_PT","metaTitle":"E-commerce","metaKeywords":"E-commerce","metaDescription":"E-commerce"}]}}},"expected":{"expected":[[]]}}},"owner":"spryker-prepare-send-category-check-and-fill-parent-sort-order","disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"spryker-check-and-send-category","name":"Spryker - Check and send - Category","description":"","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"check","value":null,"mappers":[]}]}},{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"srpyker-categories-full-data","storageKey":"&{data.id}","destination":"check"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"check"}},"conditions":[{"prototype":"equals","parameters":{"value":null}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"check"}]}},{"meta":[],"prototype":"http-transformer","parameters":{"client":"spryker-backoffice-glue","request":{"uri":"/categories","method":"POST","payload":"&{@}","plugins":[],"payloadType":"data","authentications":[]}}}],"elseTransformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"check"}]}},{"meta":[],"prototype":"http-transformer","parameters":{"client":"spryker-backoffice-glue","request":{"uri":"/categories/&{data.id}","method":"PATCH","payload":"&{@}","plugins":[],"payloadType":"data","authentications":[]}}}]}},{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"key","parameters":{"keys":[],"root":"data"}},"destination":{"prototype":"pattern","parameters":{"keys":[]}},"stripEnclosures":true}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"data"}]}}]}}]}},"owner":null,"disabled":false}
